!function(){"use strict";const{__:e}=wp.i18n;var t=class{constructor(t){this.$=$=t;const r=document.querySelectorAll(".js-twer-attach-add"),a=document.querySelectorAll(".js-twer-attach-remove");r.forEach((t=>{t.addEventListener("click",(t=>{var r,a,l,o;t.preventDefault();const s=t.target,n=s.closest(".js-twer-attach-wrap");let i;i||(i=wp.media({title:(null==n||null===(r=n.dataset)||void 0===r?void 0:r.title)||e("Select image","treweler"),button:{text:(null==n||null===(a=n.dataset)||void 0===a?void 0:a.buttonText)||e("Upload image","treweler")},library:{type:(null==n||null===(l=n.dataset)||void 0===l||null===(o=l.libraryType)||void 0===o?void 0:o.split(","))||["image"]},multiple:!1}),i.on("select",(()=>{const e=i.state().get("selection").first().toJSON(),t=e.url,r=e.id,a=n.getElementsByClassName("js-twer-attach-thumb")[0];if("application"===e.type){var l;const t=document.createElement("div");t.style.whiteSpace="nowrap",t.className="twer-app-file",t.innerText=e.filename,null===(l=n.getElementsByClassName("twer-app-file")[0])||void 0===l||l.remove(),a.appendChild(t)}else{var o;const r=document.createElement("img");r.setAttribute("src",t),r.setAttribute("alt",e.title),null===(o=n.getElementsByTagName("img")[0])||void 0===o||o.remove(),a.appendChild(r)}s.classList.contains("button")||(s.style.display="none"),a.nextElementSibling.style.display="block",n.getElementsByTagName("input")[0].value=r,$(document).trigger("twer-attach-add",[i])}))),i.open()}))})),a.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault();const t=e.target,r=t.closest(".js-twer-attach-wrap"),a=r.getElementsByClassName("js-twer-attach-thumb")[0];var l;r.getElementsByClassName("twer-app-file")?r.getElementsByClassName("twer-app-file")[0].remove():null===(l=r.getElementsByTagName("img")[0])||void 0===l||l.remove(),r.getElementsByTagName("input")[0].value="",t.closest(".js-twer-attach-actions").style.display="none",a.getElementsByClassName("js-twer-attach-add")[0].style.display="block",$(document).trigger("twer-attach-remove")}))}));const l=document.querySelectorAll(".js-twer-attach-gallery-add");$(".js-twer-attach-gallery-wrap").each(((e,t)=>{const r=$(t);r.sortable({cursor:"move",placeholder:"twer-attach-gallery__thumb",forcePlaceholderSize:!0,forceHelperSize:!0,scroll:!0,revert:!1,tolerance:"pointer",items:"> div",update:function(e,t){const a=r.find("input"),l=[];r.children("div").each((function(e,t){l.push($(t).data("id"))})),a.val(l.join(","))}}).disableSelection()})),$(document).on("click",".js-twer-attach-gallery-remove",(function(e){e.preventDefault();const t=$(this).closest(".js-twer-attach-gallery-wrap"),r=t.find("input"),a=[];$(this).closest(".twer-attach-gallery__thumb").remove(),t.children("div").each((function(e,t){a.push($(t).data("id"))})),r.val(a.join(","))})),l.forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault();const r=t.target;let a;a||(a=wp.media({title:e("Select images","treweler"),button:{text:e("Upload images","treweler")},library:{type:["image"]},multiple:"add"}),a.on("open",(()=>{const e=r.closest(".js-twer-attach-gallery-wrap").getElementsByTagName("input")[0].value;let t=a.state().get("selection");e.length>0&&e.split(",").forEach((function(e){let r=wp.media.attachment(e);r.fetch(),t.add(r?[r]:[])}))})),a.on("select",(()=>{const t=a.state().get("selection"),l=r.closest(".js-twer-attach-gallery-wrap"),o=[],s=l.getElementsByClassName("twer-attach-gallery__thumb");for(;s.length>0;)s[0].parentNode.removeChild(s[0]);t.map((function(t){t=t.toJSON();let a=document.createElement("div");a.setAttribute("class","twer-attach-gallery__thumb"),a.setAttribute("data-id",t.id);let s=document.createElement("img");s.setAttribute("src",t.url),s.setAttribute("alt",t.title);let n=document.createElement("a");n.setAttribute("href","#"),n.setAttribute("title",e("Remove","treweler")),n.setAttribute("class","twer-attach-gallery__remove js-twer-attach-gallery-remove"),a.appendChild(s),a.appendChild(n),l.insertBefore(a,r),o.push(t.id)})),l.getElementsByTagName("input")[0].value=o.join(",")}))),a.open()}))}))}};const{__:r}=wp.i18n;const{__:a}=wp.i18n;jQuery(document).ready((function(e){new t(e),new class{constructor(e){this.$=$=e;const t=document.querySelectorAll(".js-twer-tr-toggle"),r=[];t.forEach((e=>{const t=document.getElementById(e.getAttribute("id").replace("-toggle",""));r.push(t),t.options[t.selectedIndex].value===e.dataset.trigger?(e.classList.add("twer-tr-toggle--show"),e.classList.remove("twer-tr-toggle--hide")):(e.classList.remove("twer-tr-toggle--show"),e.classList.add("twer-tr-toggle--hide"))})),r.forEach((e=>{e.addEventListener("change",(e=>{const t=document.getElementById(e.target.getAttribute("id")+"-toggle");e.target.value===t.dataset.trigger?(t.classList.add("twer-tr-toggle--show"),t.classList.remove("twer-tr-toggle--hide")):(t.classList.remove("twer-tr-toggle--show"),t.classList.add("twer-tr-toggle--hide"))}))}))}}(e),new class{elementCount(e,t){return e.filter((e=>e==t)).length}constructor(e){this.$=$=e;const t=this;$(".js-ui-slider-wrap").each(((e,t)=>{const r=$(t);r.sortable({cursor:"move",placeholder:"ui-sortable-placeholder twer-tr-toggle js-ui-slider-item",forcePlaceholderSize:!0,forceHelperSize:!0,scroll:!0,revert:!1,tolerance:"pointer",handle:".js-twer-ui-sort-tr",items:"> .js-ui-slider-item",create:function(){const e=r.find("input.js-twer-custom-fields-list");let t=[];r.children(".js-ui-slider-item").each((function(e,r){t.push($(r).data("id"))})),e.val(t.join(","))},update:function(e,t){const a=r.find("input.js-twer-custom-fields-list");let l=[];r.children(".js-ui-slider-item").each((function(e,t){l.push($(t).data("id"))})),a.val(l.join(","))}}).disableSelection()})),$("select, input:checkbox").each((function(){"readonly"===$(this).attr("readonly")&&($(this).closest(".col-simple, .col-fixed").css({pointerEvents:"none"}),$(this).closest(".col-simple, .col-fixed").addClass("penoneSelect"))})),$(document).on("click",".js-twer-ui-del-tr",(function(e){e.preventDefault();const r=$(this),a=r.closest(".js-ui-slider-wrap"),l=a.find("input.js-twer-custom-fields-list"),o=a.find(".js-custom-fields-list"),s=[],n=parseInt(r.closest(".js-ui-slider-item").data("id")),i=r.closest(".js-ui-slider-item").find("th label").text();0!==o.find("option[value="+n+"]").length||isNaN(n)||o.append(`<option value="${n}">${i}</option>`),r.closest(".js-ui-slider-item").remove(),a.children(".js-ui-slider-item").each((function(e,t){s.push($(t).data("id"))})),l.val(s.join(","));const c=""!==$("#treweler-custom-fields-list").val().trim()?$("#treweler-custom-fields-list").val().split(",").map((e=>parseInt(e))):[],d=""!==$("#treweler-custom-fields-list-locator-preview").val().trim()?$("#treweler-custom-fields-list-locator-preview").val().split(",").map((e=>parseInt(e))):[],p=""!==$("#treweler-custom-fields-list-locator").val().trim()?$("#treweler-custom-fields-list-locator").val().split(",").map((e=>parseInt(e))):[],m=[...c,...d,...p];setTimeout((function(){"twer-nav-custom-fields-wo-template"!==r.closest(".tab-pane").attr("id")&&0===t.elementCount(m,n)&&$("#treweler-custom-fields-list-unique").closest(".js-ui-slider-wrap").find('.js-ui-slider-item[data-id="'+n+'"]').find(".js-twer-ui-del-tr").trigger("click")}),500),setTimeout((()=>{t.toggleNotEditableFieldsNotice()}),600)})),$(document).on("click",".js-add-custom-field",(function(e){e.preventDefault();const r=$(this),a=r.closest(".js-ui-slider-wrap"),l=a.find(".js-custom-fields-list"),o=l.val();if("none"!==o){const e=a.find('.js-hidden-item[data-id="'+o+'"]').clone(),t=[];e.find("select.js-field-multiselect").select2({placeholder:"No values selected",width:"100%",minimumResultsForSearch:-1}),e.toggleClass("d-none js-ui-slider-item"),e.removeClass("js-hidden-item"),e.find("textarea:not(.select2-search__field), input:not(:checkbox):not(.js-twer-lock-status)").each((function(){const e=$(this);e.prop("disabled",!1),e.prop("readonly",!0),e.val(e.data("default")),e.attr("value",e.data("default"))})),e.find("input.js-twer-lock-status").each((function(){const e=$(this);e.prop("disabled",!1),e.prop("readonly",!1),e.val("close"),e.attr("value","close")})),e.find(".js-twer-lock").removeClass("twer-lock--open"),e.find("input:checkbox").each((function(){const e=$(this);e.prop("disabled",!1),e.prop("readonly",!0),e.prop("checked",e.data("default")),e.closest(".col-fixed").css({pointerEvents:"none"})})),e.find("select").each((function(){const e=$(this);e.prop("disabled",!1),e.prop("readonly",!0);let t=e.data("default");t=""===t?null:"string"==typeof t?JSON.parse(t):t,e.val(t).trigger("change"),e.closest(".col-simple").css({pointerEvents:"none"}),e.closest(".col-simple").addClass("penoneSelect")})),e.insertBefore(a.find(".js-hidden-item:first")),l.find("option:selected").remove();const s=$(this).closest(".js-ui-slider-wrap"),n=s.find("input.js-twer-custom-fields-list");s.sortable("refresh"),s.sortable("refreshPositions"),s.children(".js-ui-slider-item").each((function(e,r){t.push($(r).data("id"))})),n.val(t.join(",")),setTimeout((function(){if("twer-nav-custom-fields-wo-template"!==r.closest(".tab-pane").attr("id")){const e=$("#treweler-custom-fields-list-unique").closest(".js-ui-slider-wrap");console.log(o),e.find(".js-custom-fields-list").val(o),e.find(".js-add-custom-field").trigger("click")}}),500)}setTimeout((()=>{t.toggleNotEditableFieldsNotice()}),700)})),$(document).on("click",".js-twer-lock",(function(e){e.preventDefault();const t=$(this),r=t.index(),a=t.hasClass("twer-lock--open")?"open":"close";let l=t.closest(".twer-wrap-fields").find(".twer-group-elements .row");if(l=l.length>0?l.children().eq(r):t.closest(".twer-wrap-fields").find(".twer-form-group"),"open"===a){const e=l.find("textarea:not(.select2-search__field), input:not(.js-twer-lock-status):not(:checkbox)");e.prop("readonly",!0),e.data("current",e.val()),e.val(e.data("default")),e.attr("value",e.data("default")),t.removeClass("twer-lock--open"),l.find(".js-twer-lock-status").val("close"),l.find(".js-twer-lock-status").attr("value","close");const r=l.find("input:checkbox");r.prop("disabled",!1),r.prop("readonly",!0),r.data("current",r.is(":checked")),r.prop("checked",e.data("default")),r.closest(".col-fixed").css({pointerEvents:"none"});const a=l.find("select");a.prop("disabled",!1),a.prop("readonly",!0),a.data("current",JSON.stringify(a.val()));let o=a.data("default");o=""===o?null:"string"==typeof o?JSON.parse(o):o,a.val(o).trigger("change"),a.closest(".col-simple").css({pointerEvents:"none"}),a.closest(".col-simple").addClass("penoneSelect")}if("close"===a){const e=l.find("textarea:not(.select2-search__field), input:not(.js-twer-lock-status):not(:checkbox)");e.prop("readonly",!1),e.val(e.data("current")),e.attr("value",e.data("current")),t.addClass("twer-lock--open"),l.find(".js-twer-lock-status").val("open"),l.find(".js-twer-lock-status").attr("value","open");const r=l.find("input:checkbox");r.prop("disabled",!1),r.prop("readonly",!1),r.prop("checked",r.data("current")),r.closest(".col-fixed").css({pointerEvents:"auto"});const a=l.find("select");a.prop("disabled",!1),a.prop("readonly",!1);let o=a.data("current");o=""===o?null:"string"==typeof o?JSON.parse(o):o,a.val(o).trigger("change"),a.closest(".col-simple").css({pointerEvents:"auto"}),a.closest(".col-simple").removeClass("penoneSelect")}}))}toggleNotEditableFieldsNotice(){const e=$("#js-twer-not-fields-message");e.length>0&&(e.closest(".tab-pane").find("tr").length===e.closest(".tab-pane").find("tr.d-none").length+e.closest(".tab-pane").find("tr.d-none-hard:not(.d-none)").length?e.removeClass("d-none"):e.addClass("d-none"))}}(e)}));var l,o,s="";jQuery.noConflict();const n=(e,t,r,a)=>{for(let l=0;l<e.length;l++){const o=document.getElementById(e[l]),s=document.getElementById("marker_style"),n=document.getElementsByClassName("marker-balloon__dot"),i=document.getElementsByClassName("marker--dot-solid");let c="";if(n.length>0&&"balloon-default"===s.value&&(c="treweler-picker"),i.length>0&&"dot-default"===s.value&&(c="treweler-picker-dot"),c!==o.id)continue;const d=document.getElementById(t[l]).value,p=document.getElementById(r[l]).value,m=Number.isNaN(parseFloat(document.getElementById(a[l]).value))?15:parseFloat(document.getElementById(a[l]).value);o.checked?(n.length>0&&(d.length>0?n[0].innerHTML=`<span class="marker-balloon__icon material-icons" style="color:${p};font-size:${m}px;">${d}</span>`:n[0].innerHTML=""),i.length>0&&(d.length>0?i[0].innerHTML=`<span class="marker-dot__icon material-icons" style="color:${p};font-size:${m}px;">${d}</span>`:i[0].innerHTML="")):(n.length>0&&(n[0].innerHTML=""),i.length>0&&(i[0].innerHTML=""))}};function i(){const e=$("#js-twer-not-fields-message");e.length>0&&(e.closest(".tab-pane").find("tr").length===e.closest(".tab-pane").find("tr.d-none").length+e.closest(".tab-pane").find("tr.d-none-hard:not(.d-none)").length?e.removeClass("d-none"):e.addClass("d-none"))}!function(e){e((function(){i();const t=e("#marker_style"),r=t.val(),a=e(".color-picker"),c=e("#marker_position").val();function d(e,t){return t=parseFloat(t),e=e.replace("#",""),`rgba(${parseInt(e.substring(0,2),16)},${parseInt(e.substring(2,4),16)},${parseInt(e.substring(4,6),16)},${t})`}function p(){let t=""!=e("#latitude").val().trim()&&0!=e("#latitude").val()?e("#latitude").val().trim():.1,r=""!=e("#longitude").val().trim()&&0!=e("#longitude").val()?e("#longitude").val().trim():.1,a=e("#markerColor").val(),s=e("#marker_style").val(),n=Number.isNaN(parseFloat(e("#treweler-marker-halo-opacity").val()))?.5:parseFloat(e("#treweler-marker-halo-opacity").val()),i=d(e("#marker_halo_color").val(),n),p=Number.isNaN(parseFloat(e("#treweler-marker-size").val()))?12:parseFloat(e("#treweler-marker-size").val()),m=d(e("#marker_border_color").val(),1),u=Number.isNaN(parseFloat(e("#treweler-marker-border-width").val()))?0:parseFloat(e("#treweler-marker-border-width").val()),w=(p+u+u)/2*-1,g=Number.isNaN(parseFloat(e("#treweler-marker-corner-radius-group").val()))?50:parseFloat(e("#treweler-marker-corner-radius-group").val()),k=d(e("#marker_dotcenter_color").val(),1),b=Number.isNaN(e("#treweler-marker-corner-radius-group-select").val())?"%":e("#treweler-marker-corner-radius-group-select").val(),h=d(e("#marker_color_balloon").val(),1),v=Number.isNaN(parseFloat(e("#treweler-marker-size-balloon").val()))?18:parseFloat(e("#treweler-marker-size-balloon").val()),f=d(e("#marker_border_color_balloon").val(),1),_=Number.isNaN(parseFloat(e("#treweler-marker-border-width-balloon").val()))?4:parseFloat(e("#treweler-marker-border-width-balloon").val()),y=d(e("#marker_dot_color").val(),1),N=Number.isNaN(parseFloat(e("#treweler-marker-dot-size").val()))?8:parseFloat(e("#treweler-marker-dot-size").val()),x=d(e("#marker_color_triangle").val(),1),j=Number.isNaN(parseFloat(e("#treweler-marker-width-triangle").val()))?12:parseFloat(e("#treweler-marker-width-triangle").val()),$=Number.isNaN(parseFloat(e("#treweler-marker-height-triangle").val()))?10:parseFloat(e("#treweler-marker-height-triangle").val()),E=c;o.remove();const z=document.createElement("div");if(z.className="treweler-marker","default"===s)z.innerHTML='<div class="marker"><div class="marker-wrap"><div class="marker__shadow" style="background-color:'+i+';"><div class="marker__border" style="border-color:'+a+';"><div class="marker__center"></div></div></div></div></div>';else if("dot-default"===s)z.innerHTML=`<div class="marker marker--dot-solid" style="margin-left:${w}px;margin-top:${w}px;border:${u}px solid ${m};border-radius: ${g}${b};width:${p}px;height:${p}px;background-color:${k};"></div>`,E="center";else if("balloon-default"===s){let e=`\n                        background-color: ${h};    \n                        border: ${_}px solid ${f};\n                        width: ${v}px;\n                        height: ${v}px;`,t=`\n                        width:${N}px;\n                        height:${N}px;\n                        margin-left:${N/2*-1}px;\n                        margin-top:${N/2*-1}px;\n                        background-color:${y};\n                        `;z.innerHTML=`<div class="treweler-marker marker-balloon" style="${e}"><div class="marker-balloon__dot" style="${t}"></div></div>`,E="bottom"}else if("triangle-default"===s){const e=`\n                        \n                        border-right-width:${j/2}px;\n                        border-left-width:${j/2}px;\n                        border-bottom-width: ${$}px;\n                        border-bottom-color: ${x};\n                        \n                        `;z.innerHTML=`<div class="treweler-marker marker-triangle" style="${e}"></div>`,E="center"}if(o=new mapboxgl.Marker(z,{draggable:!0,anchor:E}).setLngLat([r,t]).addTo(l),"balloon-default"===s){const t=document.getElementsByClassName("marker-balloon")[0].getBoundingClientRect().height,r=Number.isNaN(parseFloat(e("#treweler-marker-size-balloon").val()))?18:parseFloat(e("#treweler-marker-size-balloon").val()),a=Number.isNaN(parseFloat(e("#treweler-marker-border-width-balloon").val()))?4:parseFloat(e("#treweler-marker-border-width-balloon").val());e(".marker-balloon").css("bottom",(t-(r+a+a))/2)}o.on("dragend",(function(t){let r=o.getLngLat();e("#latitude").val(r.lat),e("#longitude").val(r.lng)}))}if(e("#treweler-marker-img-size").val(),e("#marker_map").length){setTimeout((function(){0===s.length&&jQuery.ajax({url:twer_ajax.url,type:"GET",data:{action:"treweler_get_admin_token"},success:function(t){try{const e=atob(t).replace("###","");s=e.replace("###","")}catch(e){s=twer_ajax.api_key}!function(){if(e(".twer-root").each((function(){e(this).find('[data-toggle="tooltip"]').tooltip({container:e(this).closest(".twer-root")})})),e("#marker_map").html(""),0!==s.length){let a=""!==e("#latitude").val().trim()&&0!==e("#latitude").val()?e("#latitude").val().trim():.1,n=""!==e("#longitude").val().trim()&&0!==e("#longitude").val()?e("#longitude").val().trim():.1,i=""!==e("#setZoom").val().trim()?e("#setZoom").val():0,m=e("#map_id option:selected").toArray().map((e=>e.dataset.map_style)),u=e("#map_id option:selected").toArray().map((e=>e.dataset.mapProjection)),w=e("#map_id option:selected").toArray().map((e=>e.dataset.mapLightPreset)),g=e("#markerColor").val(),k=Number.isNaN(parseFloat(e("#treweler-marker-halo-opacity").val()))?.5:parseFloat(e("#treweler-marker-halo-opacity").val()),b=d(e("#marker_halo_color").val(),k),h=Number.isNaN(parseFloat(e("#treweler-marker-size").val()))?12:parseFloat(e("#treweler-marker-size").val()),v=d(e("#marker_dotcenter_color").val(),1),f=d(e("#marker_border_color").val(),1),_=Number.isNaN(parseFloat(e("#treweler-marker-border-width").val()))?0:parseFloat(e("#treweler-marker-border-width").val()),y=(h+_+_)/2*-1,N=Number.isNaN(parseFloat(e("#treweler-marker-corner-radius-group").val()))?50:parseFloat(e("#treweler-marker-corner-radius-group").val()),x=Number.isNaN(e("#treweler-marker-corner-radius-group-select").val())?"%":e("#treweler-marker-corner-radius-group-select").val(),j=d(e("#marker_color_balloon").val(),1),$=Number.isNaN(parseFloat(e("#treweler-marker-size-balloon").val()))?18:parseFloat(e("#treweler-marker-size-balloon").val()),E=d(e("#marker_border_color_balloon").val(),1),z=Number.isNaN(parseFloat(e("#treweler-marker-border-width-balloon").val()))?4:parseFloat(e("#treweler-marker-border-width-balloon").val()),F=d(e("#marker_dot_color").val(),1),C=Number.isNaN(parseFloat(e("#treweler-marker-dot-size").val()))?8:parseFloat(e("#treweler-marker-dot-size").val()),I=d(e("#marker_color_triangle").val(),1),L=Number.isNaN(parseFloat(e("#treweler-marker-width-triangle").val()))?12:parseFloat(e("#treweler-marker-width-triangle").val()),T=Number.isNaN(parseFloat(e("#treweler-marker-height-triangle").val()))?10:parseFloat(e("#treweler-marker-height-triangle").val());m.length<=0&&(m=["mapbox://styles/mapbox/standard-beta"]),u.length<=0&&(u=["mercator"]),"0"===n&&(n=.1),"0"===a&&(a=.1),mapboxgl.accessToken=s,(l=new mapboxgl.Map({container:"marker_map",style:m[0],center:[n,a],zoom:i,minZoom:0,maxZoom:24,projection:{name:u[0]}})).on("style.load",(()=>{if("mapbox://styles/mapbox/standard-beta"===m[0]){let e=w[0]?w[0]:"day";l.setConfigProperty("basemap","lightPreset",e)}}));let B=new MapboxGeocoder({accessToken:mapboxgl.accessToken,mapboxgl:mapboxgl,marker:!1});if(B.on("result",(function(t){e("#latitude").val(t.result.center[1]),e("#longitude").val(t.result.center[0]),setTimeout((function(){p()}),200)})),l.addControl(B),"custom"!==e("#marker_style").val()){var t=document.createElement("div");let s=c;if(t.className="treweler-marker","default"===r)t.innerHTML='<div class="marker"><div class="marker-wrap"><div class="marker__shadow" style="background-color:'+b+';"><div class="marker__border" style="border-color:'+g+';"><div class="marker__center"></div></div></div></div></div>';else if("dot-default"===r)t.innerHTML=`<div class="marker marker--dot-solid" style="margin-left:${y}px;margin-top:${y}px;border:${_}px solid ${f};border-radius: ${N}${x};width:${h}px;height:${h}px;background-color:${v};"></div>`,s="center";else if("balloon-default"===r){let e=`\n                        background-color: ${j};    \n                        border: ${z}px solid ${E};\n                        width: ${$}px;\n                        height: ${$}px;`,r=`\n                        width:${C}px;\n                        height:${C}px;\n                        margin-left:${C/2*-1}px;\n                        margin-top:${C/2*-1}px;\n                        background-color:${F};\n                        `;t.innerHTML=`<div class="treweler-marker marker-balloon" style="${e}"><div class="marker-balloon__dot" style="${r}"></div></div>`,s="bottom"}else if("triangle-default"===r){const e=`\n                        \n                        border-right-width:${L/2}px;\n                        border-left-width:${L/2}px;\n                        border-bottom-width: ${T}px;\n                        border-bottom-color: ${I};\n                        \n                        `;t.innerHTML=`<div class="treweler-marker marker-triangle" style="${e}"></div>`,s="center"}if(o=new mapboxgl.Marker(t,{draggable:!0,anchor:s}).setLngLat([n,a]).addTo(l),"balloon-default"===r){const t=document.getElementsByClassName("marker-balloon")[0].getBoundingClientRect().height,r=Number.isNaN(parseFloat(e("#treweler-marker-size-balloon").val()))?18:parseFloat(e("#treweler-marker-size-balloon").val()),a=Number.isNaN(parseFloat(e("#treweler-marker-border-width-balloon").val()))?4:parseFloat(e("#treweler-marker-border-width-balloon").val());e(".marker-balloon").css("bottom",(t-(r+a+a))/2)}}else{let r=e(".js-twer-attach-wrap-custom img").attr("src"),s=e("#marker_position").val(),i=""!=e("#marker_icon_size").val()?e("#marker_icon_size").val().split(";"):"42;42".split(";"),c=parseInt(i[0])<=42?parseInt(i[0])%2==0?parseInt(i[0]):parseInt(i[0])+1:42,d=parseInt(i[1])<=42?parseInt(i[1])%2==0?parseInt(i[1]):parseInt(i[1])+1:42,p=Number.isNaN(parseInt(e("#treweler-marker-img-size").val()))?42:parseInt(e("#treweler-marker-img-size").val());(t=document.createElement("div")).className="treweler-marker icon",t.style.backgroundImage="url("+r+")",t.style.backgroundSize="contain",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="center center",t.style.width=parseInt(p)>1?parseInt(p)+"px":parseInt(d)+"px",t.style.height=parseInt(p)>1?parseInt(p)+"px":parseInt(c)+"px",o=new mapboxgl.Marker(t,{draggable:!0,anchor:s}).setLngLat([n,a]).addTo(l)}o.on("dragend",(function(t){let r=o.getLngLat();e("#latitude").val(r.lat),e("#longitude").val(r.lng)})),l.on("click",(function(t){o.setLngLat([t.lngLat.lng,t.lngLat.lat]).addTo(l),e("#latitude").val(t.lngLat.lat),e("#longitude").val(t.lngLat.lng)})),l.on("zoom",(function(t){let r=l.getZoom().toFixed(2);e("#setZoom").val(r)}))}else e("#marker_map").append('<p class="notice notice-error settings-error is-dismissible">Mapbox access token is required.</p>');n(["treweler-picker","treweler-picker-dot"],["treweler-balloon-icon-picker","treweler-dot-icon-picker"],["balloon_icon_color","dot_icon_color"],["treweler-balloon-icon-size","treweler-dot-icon-size"])}()}})}),1e3),e("#latitude, #longitude").on("change input",(function(){""!=e("#latitude").val().trim()&&""!=e("#longitude").val().trim()&&(o.setLngLat([e("#longitude").val(),e("#latitude").val()]).addTo(l),l.setCenter([e("#longitude").val(),e("#latitude").val()]))}));let a="",i="";e(".js-twer-select-2").on("select2:select.bsnselect",(function(t){var r=t.params.data.element,o=e(r);o.detach(),e(this).append(o),e(this).trigger("change");let s=e("#map_id option:selected").toArray().map((e=>e.dataset.map_style)),n=e("#map_id option:selected").toArray().map((e=>e.dataset.mapProjection)),c=e("#map_id option:selected").toArray().map((e=>e.dataset.mapLightPreset));s.length<=0&&(s=["mapbox://styles/mapbox/standard-beta"]),n.length<=0&&(n=["mercator"]),a=s[0],l.setStyle(s[0]),i=n[0],l.setProjection(n[0]),"mapbox://styles/mapbox/standard-beta"===s[0]&&l.on("style.load",(()=>{let e=c[0]?c[0]:"day";l.setConfigProperty("basemap","lightPreset",e)}))})),e(".js-twer-select-2").on("change",(function(){let t=e("#map_id option:selected").toArray().map((e=>e.dataset.map_style)),r=e("#map_id option:selected").toArray().map((e=>e.dataset.mapProjection)),o=e("#map_id option:selected").toArray().map((e=>e.dataset.mapLightPreset));t.length<=0&&(t=["mapbox://styles/mapbox/standard-beta"],l.setStyle(t[0])),t.length>0&&!t.includes(a)&&(a=t[0],l.setStyle(a)),r.length<=0&&(r=["mercator"],l.setProjection(r[0])),r.length>0&&!r.includes(i)&&(i=r[0],l.setProjection(i)),"mapbox://styles/mapbox/standard-beta"===t[0]&&l.on("style.load",(()=>{let e=o[0]?o[0]:"day";l.setConfigProperty("basemap","lightPreset",e)}))})),t.on("change",(function(){if(e('.js-twer-attach-wrap-custom input[type="hidden"]').val()>=1)return;let t=""!=e("#latitude").val().trim()&&0!=e("#latitude").val()?e("#latitude").val().trim():.1,r=""!=e("#longitude").val().trim()&&0!=e("#longitude").val()?e("#longitude").val().trim():.1,a=e("#markerColor").val(),s=Number.isNaN(parseFloat(e("#treweler-marker-halo-opacity").val()))?.5:parseFloat(e("#treweler-marker-halo-opacity").val()),i=d(e("#marker_halo_color").val(),s),p=Number.isNaN(parseFloat(e("#treweler-marker-size").val()))?12:parseFloat(e("#treweler-marker-size").val()),m=d(e("#marker_border_color").val(),1),u=Number.isNaN(parseFloat(e("#treweler-marker-border-width").val()))?0:parseFloat(e("#treweler-marker-border-width").val()),w=(p+u+u)/2*-1,g=d(e("#marker_dotcenter_color").val(),1),k=Number.isNaN(parseFloat(e("#treweler-marker-corner-radius-group").val()))?50:parseFloat(e("#treweler-marker-corner-radius-group").val()),b=Number.isNaN(e("#treweler-marker-corner-radius-group-select").val())?"%":e("#treweler-marker-corner-radius-group-select").val(),h=d(e("#marker_color_balloon").val(),1),v=Number.isNaN(parseFloat(e("#treweler-marker-size-balloon").val()))?18:parseFloat(e("#treweler-marker-size-balloon").val()),f=d(e("#marker_border_color_balloon").val(),1),_=Number.isNaN(parseFloat(e("#treweler-marker-border-width-balloon").val()))?4:parseFloat(e("#treweler-marker-border-width-balloon").val()),y=d(e("#marker_dot_color").val(),1),N=Number.isNaN(parseFloat(e("#treweler-marker-dot-size").val()))?8:parseFloat(e("#treweler-marker-dot-size").val()),x=d(e("#marker_color_triangle").val(),1),j=Number.isNaN(parseFloat(e("#treweler-marker-width-triangle").val()))?12:parseFloat(e("#treweler-marker-width-triangle").val()),$=Number.isNaN(parseFloat(e("#treweler-marker-height-triangle").val()))?10:parseFloat(e("#treweler-marker-height-triangle").val()),E=c;o.remove();var z=document.createElement("div");let F=e(this).val();if(z.className="treweler-marker","default"===F)z.innerHTML='<div class="marker"><div class="marker-wrap"><div class="marker__shadow" style="background-color:'+i+';"><div class="marker__border" style="border-color:'+a+';"><div class="marker__center"></div></div></div></div></div>';else if("dot-default"===F)z.innerHTML=`<div class="marker marker--dot-solid" style="margin-left:${w}px;margin-top:${w}px;border:${u}px solid ${m};border-radius: ${k}${b};width:${p}px;height:${p}px;background-color:${g};"></div>`,E="center";else if("balloon-default"===F){let e=`\n                        background-color: ${h};    \n                        border: ${_}px solid ${f};\n                        width: ${v}px;\n                        height: ${v}px;`,t=`\n                        width:${N}px;\n                        height:${N}px;\n                        margin-left:${N/2*-1}px;\n                        margin-top:${N/2*-1}px;\n                        background-color:${y};\n                        `;z.innerHTML=`<div class="treweler-marker marker-balloon" style="${e}"><div class="marker-balloon__dot" style="${t}"></div></div>`,E="bottom"}else if("triangle-default"===F){const e=`\n                        \n                        border-right-width:${j/2}px;\n                        border-left-width:${j/2}px;\n                        border-bottom-width: ${$}px;\n                        border-bottom-color: ${x};\n                        \n                        `;z.innerHTML=`<div class="treweler-marker marker-triangle" style="${e}"></div>`,E="center"}if(o=new mapboxgl.Marker(z,{draggable:!0,anchor:E}).setLngLat([r,t]).addTo(l),"balloon-default"===F){const t=document.getElementsByClassName("marker-balloon")[0].getBoundingClientRect().height,r=Number.isNaN(parseFloat(e("#treweler-marker-size-balloon").val()))?18:parseFloat(e("#treweler-marker-size-balloon").val()),a=Number.isNaN(parseFloat(e("#treweler-marker-border-width-balloon").val()))?4:parseFloat(e("#treweler-marker-border-width-balloon").val());e(".marker-balloon").css("bottom",(t-(r+a+a))/2)}if(o.on("dragend",(function(t){let r=o.getLngLat();e("#latitude").val(r.lat),e("#longitude").val(r.lng)})),"custom"===F){let t={url:e('.js-twer-attach-thumb-custom input[type="hidden"]').val()};if(t.url.length>0){let r=""!=e("#latitude").val().trim()&&0!=e("#latitude").val()?e("#latitude").val().trim():.1,a=""!=e("#longitude").val().trim()&&0!=e("#longitude").val()?e("#longitude").val().trim():.1,s=e("#marker_position").val(),n=42,i=42,c=Number.isNaN(parseInt(e("#treweler-marker-img-size").val()))?42:parseInt(e("#treweler-marker-img-size").val());o.remove(),(z=document.createElement("div")).className="treweler-marker icon",z.style.backgroundImage="url("+t.url+")",z.style.backgroundSize="contain",z.style.backgroundRepeat="no-repeat",z.style.backgroundPosition="center center",z.style.width=parseInt(c)>1?parseInt(c)+"px":i+"px",z.style.height=parseInt(c)>1?parseInt(c)+"px":n+"px",o=new mapboxgl.Marker(z,{draggable:!0,anchor:s}).setLngLat([a,r]).addTo(l),o.on("dragend",(function(t){let r=o.getLngLat();e("#latitude").val(r.lat),e("#longitude").val(r.lng)}))}}n(["treweler-picker","treweler-picker-dot"],["treweler-balloon-icon-picker","treweler-dot-icon-picker"],["balloon_icon_color","dot_icon_color"],["treweler-balloon-icon-size","treweler-dot-icon-size"])}));const m=document.querySelectorAll(".js-twer-attach-add-custom"),u=document.querySelectorAll(".js-twer-attach-remove-custom");let w;m.forEach((t=>{t.addEventListener("click",(t=>{t.preventDefault();const r=t.target;w||(w=wp.media({title:"Select file",button:{text:"Upload file"},library:{type:["image"]},multiple:!1}),w.on("select",(()=>{var t;const a=w.state().get("selection").first(),s=a.toJSON().url,n=(a.attributes.filename,r.closest(".js-twer-attach-wrap-custom")),i=n.getElementsByClassName("js-twer-attach-thumb-custom")[0],c=document.createElement("IMG");c.setAttribute("src",s),c.setAttribute("alt",a.changed.title),null===(t=n.getElementsByTagName("img")[0])||void 0===t||t.remove(),i.appendChild(c),r.classList.contains("button")||(r.style.display="none"),i.nextElementSibling.style.display="block",n.getElementsByTagName("input")[0].value=s;let d=w.state().get("selection").first().toJSON(),p=""!=e("#latitude").val().trim()&&0!=e("#latitude").val()?e("#latitude").val().trim():.1,m=""!=e("#longitude").val().trim()&&0!=e("#longitude").val()?e("#longitude").val().trim():.1,u=e("#marker_position").val();if("svg+xml"===d.subtype)jQuery.ajax({type:"GET",url:d.url,success:function(t){let r=document.createElement("div");r.innerHTML=(new XMLSerializer).serializeToString(t.documentElement);let a=parseInt(e(r).find("svg").attr("height")),s=parseInt(e(r).find("svg").attr("width")),n=a<=42?a%2==0?a:a+1:42,i=s<=42?s%2==0?s:s+1:42,c=Number.isNaN(parseInt(e("#treweler-marker-img-size").val()))?42:parseInt(e("#treweler-marker-img-size").val());o.remove();var w=document.createElement("div");w.className="treweler-marker icon",w.style.backgroundImage="url("+d.url+")",w.style.backgroundSize="contain",w.style.backgroundRepeat="no-repeat",w.style.backgroundPosition="center center",w.style.width=parseInt(c)>1?parseInt(c)+"px":i+"px",w.style.height=parseInt(c)>1?parseInt(c)+"px":n+"px",(o=new mapboxgl.Marker(w,{draggable:!0,anchor:u}).setLngLat([m,p]).addTo(l)).on("dragend",(function(t){let r=o.getLngLat();e("#latitude").val(r.lat),e("#longitude").val(r.lng)})),e("#marker_icon_size").val(n+";"+i)}});else{let t=d.height<=42?d.height%2==0?d.height:d.height+1:42,r=d.width<=42?d.width%2==0?d.width:d.width+1:42,a=Number.isNaN(parseInt(e("#treweler-marker-img-size").val()))?42:parseInt(e("#treweler-marker-img-size").val());o.remove();var g=document.createElement("div");g.className="treweler-marker icon",g.style.backgroundImage="url("+d.url+")",g.style.backgroundSize="contain",g.style.backgroundRepeat="no-repeat",g.style.backgroundPosition="center center",g.style.width=parseInt(a)>1?parseInt(a)+"px":r+"px",g.style.height=parseInt(a)>1?parseInt(a)+"px":t+"px",(o=new mapboxgl.Marker(g,{draggable:!0,anchor:u}).setLngLat([m,p]).addTo(l)).on("dragend",(function(t){let r=o.getLngLat();e("#latitude").val(r.lat),e("#longitude").val(r.lng)})),e("#marker_icon_size").val(t+";"+r)}}))),w.open()}))})),u.forEach((t=>{t.addEventListener("click",(t=>{var r;t.preventDefault();const a=t.target,l=a.closest(".js-twer-attach-wrap-custom"),o=l.getElementsByClassName("js-twer-attach-thumb-custom")[0];null===(r=l.getElementsByTagName("img")[0])||void 0===r||r.remove(),l.getElementsByTagName("input")[0].value="",a.closest(".js-twer-attach-actions-custom").style.display="none",o.getElementsByClassName("js-twer-attach-add-custom")[0].style.display="block",p(),e("#marker_icon_size").val("")}))}))}e("#color-picker-btn, .clr-picker span").on("click",(function(){let t=e("#marker_style").val();0===a.find(".a-color-picker").length?TWER_HELPERS.AColorPicker.from(".color-picker").on("change",((r,l)=>{["default"].includes(t)?e(".treweler-marker .marker .marker__border").css("border-color",r.color):["dot-default"].includes(t)&&e(".treweler-marker .marker").css("background-color",r.color),e(".clr-picker span").css("background-color",r.color),e("#markerColor").val(r.color),a.attr("acp-color",r.color)})).on("coloradd",((t,r)=>{let l=e("#addCustomColor");-1===l.val().indexOf("|"+r)&&(l.val(l.val()+"|"+r),jQuery.ajax({url:twer_ajax.url,type:"POST",data:{action:"treweler_add_colorpicker_custom_color",cust_color:l.val()},success:function(e){let t=a,r=t.attr("default-palette");t.attr("acp-palette",r+""+e)}}))})).on("colorremove",((t,r)=>{let l=e("#addCustomColor");if(-1!==l.val().indexOf("|"+r)){let e=l.val().replace("|"+r,"");l.val(e),jQuery.ajax({url:twer_ajax.url,type:"POST",data:{action:"treweler_add_colorpicker_custom_color",cust_color:l.val()},success:function(e){let t=a,r=t.attr("default-palette");t.attr("acp-palette",r+""+e)}})}})):a.find(".a-color-picker").remove()})),e(".js-twer-color-picker").on("click",(function(t){t.stopPropagation();var r=e(this),l=r.children("span"),o=r.closest(".js-twer-color-picker-wrap"),s=o.find(".js-twer-color-picker-palette"),i=o.find('input[type="hidden"]');0===s.find(".a-color-picker").length?TWER_HELPERS.AColorPicker.from(s[0]).on("change",((t,r)=>{switch(l.css("background-color",t.color),i.val(t.color),s.attr("acp-color",t.color),i.attr("id")){case"marker_dotcenter_color":e(".marker.marker--dot-solid").css("background-color",d(t.color,1));break;case"marker_halo_color":let r=e("#treweler-marker-halo-opacity").val();r=Number.isNaN(parseFloat(r))?.5:parseFloat(r),e(".treweler-marker .marker .marker__shadow").css("background-color",d(t.color,r));break;case"marker_border_color":e(".treweler-marker .marker").css("border-color",d(t.color,1));break;case"marker_dot_color":e(".treweler-marker.marker-balloon .marker-balloon__dot").css("background-color",d(t.color,1));break;case"marker_color_balloon":e(".treweler-marker.marker-balloon").css("background-color",d(t.color,1));break;case"marker_border_color_balloon":e(".treweler-marker.marker-balloon").css("border-color",d(t.color,1));break;case"marker_color_triangle":e(".treweler-marker.marker-triangle").css("border-bottom-color",d(t.color,1));break;case"balloon_icon_color":case"dot_icon_color":n(["treweler-picker","treweler-picker-dot"],["treweler-balloon-icon-picker","treweler-dot-icon-picker"],["balloon_icon_color","dot_icon_color"],["treweler-balloon-icon-size","treweler-dot-icon-size"])}})).on("coloradd",((t,r)=>{let l=e("#addCustomColor");-1===l.val().indexOf("|"+r)&&(l.val(l.val()+"|"+r),jQuery.ajax({url:twer_ajax.url,type:"POST",data:{action:"treweler_add_colorpicker_custom_color",cust_color:l.val()},success:function(e){let t=s.attr("default-palette");s.attr("acp-palette",t+""+e),s.attr("acp-palette",t+""+e),a.attr("acp-palette",t+""+e)}}))})).on("colorremove",((t,r)=>{let a=e("#addCustomColor");if(-1!==a.val().indexOf("|"+r)){let e=a.val().replace("|"+r,"");a.val(e),jQuery.ajax({url:twer_ajax.url,type:"POST",data:{action:"treweler_add_colorpicker_custom_color",cust_color:a.val()},success:function(e){let t=s.attr("default-palette");s.attr("acp-palette",t+""+e)}})}})):s.find(".a-color-picker").remove()})),e(".js-twer-color-picker-palette").on("click",(function(e){e.stopPropagation()})),e("#treweler-marker-corner-radius-group-select").on("change",(function(){let t=Number.isNaN(parseFloat(e("#treweler-marker-corner-radius-group").val()))?50:parseFloat(e("#treweler-marker-corner-radius-group").val());const r=Number.isNaN(this.value)?"%":this.value;e(".treweler-marker .marker").css("borderRadius",`${t}${r}`)})),e(["#treweler-marker-halo-opacity","#treweler-marker-size","#treweler-marker-border-width","#treweler-marker-corner-radius-group","#treweler-marker-size-balloon","#treweler-marker-border-width-balloon","#treweler-marker-dot-size","#treweler-marker-width-triangle","#treweler-marker-height-triangle","#treweler-balloon-icon-size","#treweler-dot-icon-size"].join()).on("keyup change",(function(){let t=e(this).val();const r=e(".treweler-marker .marker");switch(this.id){case"treweler-balloon-icon-size":case"treweler-dot-icon-size":n(["treweler-picker","treweler-picker-dot"],["treweler-balloon-icon-picker","treweler-dot-icon-picker"],["balloon_icon_color","dot_icon_color"],["treweler-balloon-icon-size","treweler-dot-icon-size"]);break;case"treweler-marker-width-triangle":e(".treweler-marker.marker-triangle").length>0&&(t=Number.isNaN(parseFloat(t))?12:parseFloat(t),e(".treweler-marker.marker-triangle").css({borderRightWidth:t/2+"px",borderLeftWidth:t/2+"px"}));break;case"treweler-marker-height-triangle":e(".treweler-marker.marker-triangle").length&&(t=Number.isNaN(parseFloat(t))?10:parseFloat(t),e(".treweler-marker.marker-triangle").css({borderBottomWidth:`${t}px`}));break;case"treweler-marker-size-balloon":if(e(".treweler-marker.marker-balloon").length>0){t=Number.isNaN(parseFloat(t))?18:parseFloat(t),e(".treweler-marker.marker-balloon").css({width:`${t}px`,height:`${t}px`});const r=document.getElementsByClassName("marker-balloon");if(r.length>0){const a=r[0].getBoundingClientRect().height,l=Number.isNaN(parseFloat(e("#treweler-marker-border-width-balloon").val()))?4:parseFloat(e("#treweler-marker-border-width-balloon").val());e(".treweler-marker.marker-balloon").css({bottom:(a-(t+l+l))/2})}}break;case"treweler-marker-border-width-balloon":if(e(".treweler-marker.marker-balloon").length>0){t=Number.isNaN(parseFloat(t))?4:parseFloat(t),e(".treweler-marker.marker-balloon").css({borderWidth:`${t}px`});const r=document.getElementsByClassName("marker-balloon");if(r.length>0){const a=r[0].getBoundingClientRect().height,l=Number.isNaN(parseFloat(e("#treweler-marker-size-balloon").val()))?18:parseFloat(e("#treweler-marker-size-balloon").val());e(".treweler-marker.marker-balloon").css({bottom:(a-(l+t+t))/2})}}break;case"treweler-marker-dot-size":e(".treweler-marker.marker-balloon .marker-balloon__dot").length>0&&(t=Number.isNaN(parseFloat(t))?8:parseFloat(t),e(".treweler-marker.marker-balloon .marker-balloon__dot").css({width:`${t}px`,height:`${t}px`,marginLeft:t/2*-1+"px",marginTop:t/2*-1+"px"}));break;case"treweler-marker-halo-opacity":e(".treweler-marker .marker .marker__shadow").length>0&&(t=Number.isNaN(parseFloat(t))?.5:parseFloat(t),e(".treweler-marker .marker .marker__shadow").css("background-color",d(e("#marker_halo_color").val(),t)));break;case"treweler-marker-size":if(r.length>0){t=Number.isNaN(parseFloat(t))?12:parseFloat(t);const r=Number.isNaN(parseFloat(e("#treweler-marker-border-width").val()))?0:parseFloat(e("#treweler-marker-border-width").val());e(".treweler-marker .marker.marker--dot-solid").css({width:`${t}px`,height:`${t}px`,marginLeft:(t+r+r)/2*-1+"px",marginTop:(t+r+r)/2*-1+"px"})}break;case"treweler-marker-border-width":if(r.length>0){t=Number.isNaN(parseFloat(t))?0:parseFloat(t);const r=Number.isNaN(parseFloat(e("#treweler-marker-size").val()))?12:parseFloat(e("#treweler-marker-size").val());e(".treweler-marker .marker.marker--dot-solid").css({width:`${r}px`,height:`${r}px`,borderWidth:`${t}px`,marginLeft:(r+t+t)/2*-1+"px",marginTop:(r+t+t)/2*-1+"px"})}break;case"treweler-marker-corner-radius-group":if(r.length>0){t=Number.isNaN(parseFloat(t))?50:parseFloat(t);let r=Number.isNaN(e("#treweler-marker-corner-radius-group-select").val())?"%":e("#treweler-marker-corner-radius-group-select").val();e(".treweler-marker .marker.marker--dot-solid").css("borderRadius",`${t}${r}`)}}})),e(window).on("click",(function(){e(".js-twer-color-picker-palette").find(".a-color-picker").remove()})),e(window).on("click",(function(t){e(t.target).hasClass("a-color-picker")||0!==e(t.target).parents(".a-color-picker").length||"color-picker-btn"===e(t.target).attr("id")||e(t.target).hasClass("color-holder")||e(t.target).hasClass("a-color-picker-palette-color")||a.find(".a-color-picker").remove()})),e(document).on("change","#marker_position,#treweler-marker-img-size",(function(){let t=e(".js-twer-attach-wrap-custom img");if(void 0!==t.length&&t.length>0){let t=""!==e("#latitude").val().trim()&&0!==e("#latitude").val()?e("#latitude").val().trim():.1,a=""!==e("#longitude").val().trim()&&0!==e("#longitude").val()?e("#longitude").val().trim():.1,s=e(".js-twer-attach-wrap-custom img").attr("src"),n=e("#marker_position").val(),i=Number.isNaN(parseInt(e("#treweler-marker-img-size").val()))?42:parseInt(e("#treweler-marker-img-size").val()),c=""!==e("#marker_icon_size").val()?e("#marker_icon_size").val().split(";"):"42;42".split(";"),d=parseInt(c[0])<=42?parseInt(c[0])%2==0?parseInt(c[0]):parseInt(c[0])+1:42,p=parseInt(c[1])<=42?parseInt(c[1])%2==0?parseInt(c[1]):parseInt(c[1])+1:42;o.remove();var r=document.createElement("div");r.className="treweler-marker icon",r.style.backgroundImage="url("+s+")",r.style.backgroundSize="contain",r.style.backgroundRepeat="no-repeat",r.style.backgroundPosition="center center",r.style.width=parseInt(i)>1?parseInt(i)+"px":parseInt(p)+"px",r.style.height=parseInt(i)>1?parseInt(i)+"px":parseInt(d)+"px",(o=new mapboxgl.Marker(r,{draggable:!0,anchor:n}).setLngLat([a,t]).addTo(l)).on("dragend",(function(t){let r=o.getLngLat();e("#latitude").val(r.lat),e("#longitude").val(r.lng)}))}}));const m=jQuery("#treweler-balloon-icon-picker").fontIconPicker({iconGenerator:function(e){return'<i class="material-icons">'+e+"</i>"}});m.on("change",(function(){n(["treweler-picker"],["treweler-balloon-icon-picker"],["balloon_icon_color"],["treweler-balloon-icon-size"])}));const u=new XMLHttpRequest;u.open("GET",twer_ajax.fonts_url+"material-icons.json"),u.send(),u.onload=()=>{if(u.status>=200&&u.status<300){const e=u.response;e&&m.setIcons(JSON.parse(e))}else console.log(`Error: ${u.status}: ${u.statusText}`)},u.onerror=()=>console.log(u.statusText),window.TWER_FONTPICKERS=m;const w=jQuery("#treweler-dot-icon-picker").fontIconPicker({iconGenerator:function(e){return'<i class="material-icons">'+e+"</i>"}});w.on("change",(function(){n(["treweler-picker-dot"],["treweler-dot-icon-picker"],["dot_icon_color"],["treweler-dot-icon-size"])}));const g=new XMLHttpRequest;let k;function b(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data-current";return null==e||null===(t=e.get(0))||void 0===t?void 0:t.hasAttribute(r)}function h(t,r,a,l){const o=e(t);if("checkbox"===r){if("reset"===l&&(a=o.attr("data-current")),"set"===l){const e=o.is(":checked");o.closest(".twer-switcher").attr("data-default",a),o.closest(".twer-switcher").attr("data-readonly","true"),b(o.closest(".twer-switcher"))||o.closest(".twer-switcher").attr("data-current",e?"1":"0"),o.prop("checked",parseInt(a))}}else if("colorpicker"===r){if("reset"===l&&(a=o.closest(".twer-color-picker-wrap").attr("data-current")),"set"===l){const e=o.val();b(o.closest(".twer-color-picker-wrap"))||o.closest(".twer-color-picker-wrap").attr("data-current",e),o.val(a),o.attr("value",a),o.closest(".twer-color-picker-wrap").attr("data-default",a),o.closest(".twer-color-picker-wrap").attr("data-readonly","true"),o.closest(".twer-color-picker-wrap").find(".color-holder").css("background-color",a),o.closest(".twer-color-picker-wrap").find(".twer-color-picker-palette").attr("acp-color",a)}}else if("text"===r||"number"===r||"url"===r){if("reset"===l&&(a=o.attr("data-current")),"set"===l){const e=o.val();b(o)||o.attr("data-current",e),o.attr("data-default",a),o.val(a),o.attr("value",a),o.attr("data-readonly","true")}}else if("select"===r){if("reset"===l&&(a=o.attr("data-current")),"set"===l){const e=o.val();b(o)||o.attr("data-current",e),o.attr("data-default",a),o.val(a),o.attr("data-readonly","true")}}else if("iconpicker"===r){if("reset"===l&&(a=o.attr("data-current")),"set"===l){const e=o.val();o.prev(".icons-selector").attr("data-readonly","true"),b(o)||o.attr("data-current",e),o.attr("data-default",a),o.val(a),o.attr("value",a),"treweler-balloon-icon-picker"===o.attr("id")&&window.TWER_FONTPICKERS.setIcon(a),"treweler-dot-icon-picker"===o.attr("id")&&window.TWER_FONTPICKERS1.setIcon(a)}}else if("image"===r){if("reset"===l&&(a=o.attr("data-current")),"set"===l){const r=o.val();e(".js-twer-attach-remove-custom").trigger("click"),o.closest(".js-twer-attach-wrap-custom").attr("data-readonly","true"),b(o.closest(".js-twer-attach-wrap-custom"))||o.closest(".js-twer-attach-wrap-custom").attr("data-current",r),k=wp.media.attachment(a).fetch().then((function(r){var l;let s=wp.media.attachment(a).get("url");e(t).val(s),e(t).attr("value",s),o.closest(".js-twer-attach-wrap-custom").attr("data-default",s);let n=e(".js-twer-attach-wrap-custom")[0];const i=n.getElementsByClassName("js-twer-attach-thumb-custom")[0],c=e(".js-twer-attach-add-custom")[0],d=document.createElement("IMG");d.setAttribute("src",s),null===(l=n.getElementsByTagName("img")[0])||void 0===l||l.remove(),i.appendChild(d),c.classList.contains("button")||(c.style.display="none"),i.nextElementSibling.style.display="block",n.getElementsByTagName("input")[0].value=s}))}}else if("gallery"===r&&("reset"===l&&(a=o.attr("data-current")),"set"===l)){const t=o.val();if(b(o.closest(".twer-attach-gallery"))||o.closest(".twer-attach-gallery").attr("data-current",t),o.closest(".twer-attach-gallery").attr("data-default",a),o.val(a),o.attr("value",a),o.closest(".twer-attach-gallery").attr("data-readonly","true"),e(".twer-attach-gallery__thumb").remove(),o.val()){let t=o.val().split(",");for(let r=0;r<t.length;r++)wp.media.attachment(t[r]).fetch().then((function(a){let l=wp.media.attachment(t[r]).get("url"),o=document.createElement("div");o.setAttribute("class","twer-attach-gallery__thumb"),o.setAttribute("data-id",t[r]);let s=document.createElement("img");s.setAttribute("src",l);let n=document.createElement("a");n.setAttribute("href","#"),n.setAttribute("class","twer-attach-gallery__remove js-twer-attach-gallery-remove"),o.appendChild(s),o.appendChild(n),e(".js-twer-attach-gallery-wrap")[0].insertBefore(o,e(".js-twer-attach-gallery-add")[0])}))}}}g.open("GET",twer_ajax.fonts_url+"material-icons.json"),g.send(),g.onload=()=>{if(g.status>=200&&g.status<300){const e=g.response;e&&w.setIcons(JSON.parse(e))}else console.log(`Error: ${g.status}: ${g.statusText}`)},g.onerror=()=>console.log(g.statusText),window.TWER_FONTPICKERS1=w,e(".icons-selector").each((function(){let t=e(this).next().attr("data-readonly");void 0!==t&&!1!==t&&e(this).attr("data-readonly","true")})),e(document).on("click",".js-twer-lock-default",(function(t){t.preventDefault();const r=e(this),a=e(this).find("input"),l=r.index(),o=r.hasClass("twer-lock--open")?"open":"close";let s=r.closest(".twer-wrap-fields").find(".twer-group-elements .row");if(s=s.length>0?s.children().eq(l):r.closest(".twer-wrap-fields"),"open"===o){a.attr("value","close"),a.val("close"),r.removeClass("twer-lock--open");const t=s.find("select"),l=t.val();t.attr("data-readonly","true"),t.attr("data-current",l),t.val(t.attr("data-default")),t.trigger("change");const o=s.find(".twer-switcher"),i=o.find("input:checkbox"),c=i.is(":checked");o.attr("data-readonly","true"),o.attr("data-current",c?"1":"0"),i.prop("checked",parseInt(o.attr("data-default"))),i.trigger("change");const d=s.find(".icons-selector"),p=d.next("input"),m=p.val(),u=p.attr("data-default");"treweler-balloon-icon-picker"===p.attr("id")&&window.TWER_FONTPICKERS.setIcon(u),"treweler-dot-icon-picker"===p.attr("id")&&window.TWER_FONTPICKERS1.setIcon(u),d.attr("data-readonly","true"),p.attr("data-readonly","true"),p.attr("data-current",m);const w=s.find(".twer-color-picker-wrap"),g=w.find(".input-color-field"),k=g.val(),b=w.find(".color-holder"),h=w.find(".twer-color-picker-palette"),v=w.attr("data-default");g.val(v),g.attr("value",v),b.css("background-color",v),h.attr("acp-color",v),w.attr("data-readonly","true"),w.attr("data-current",k);const f=s.find(".large-text"),_=f.val(),y=f.attr("data-default");f.val(y),f.attr("value",y),f.attr("data-readonly","true"),f.attr("data-current",_);const N=s.find(".twer-attach"),x=N.find('input[type="hidden"]'),j=x.val(),$=N.attr("data-default");if(x.val($),x.attr("value",$),N.attr("data-readonly","true"),N.attr("data-current",j),$!==j){var n;e(".js-twer-attach-remove-custom").trigger("click");let t=$,r=N[0];const a=r.getElementsByClassName("js-twer-attach-thumb-custom")[0],l=e(".js-twer-attach-add-custom")[0],o=document.createElement("IMG");o.setAttribute("src",t),null===(n=r.getElementsByTagName("img")[0])||void 0===n||n.remove(),a.appendChild(o),l.classList.contains("button")||(l.style.display="none"),a.nextElementSibling.style.display="block",r.getElementsByTagName("input")[0].value=t}const E=s.find(".js-twer-attach-gallery-wrap"),z=E.find('input[type="hidden"]'),F=z.val(),C=E.attr("data-default");if(z.val(C),z.attr("value",C),E.attr("data-readonly","true"),E.attr("data-current",j),C!==F&&(e(".twer-attach-gallery__thumb").remove(),z.val())){let t=z.val().split(",");for(let r=0;r<t.length;r++)wp.media.attachment(t[r]).fetch().then((function(a){let l=wp.media.attachment(t[r]).get("url"),o=document.createElement("div");o.setAttribute("class","twer-attach-gallery__thumb"),o.setAttribute("data-id",t[r]);let s=document.createElement("img");s.setAttribute("src",l);let n=document.createElement("a");n.setAttribute("href","#"),n.setAttribute("class","twer-attach-gallery__remove js-twer-attach-gallery-remove"),o.appendChild(s),o.appendChild(n),e(".js-twer-attach-gallery-wrap")[0].insertBefore(o,e(".js-twer-attach-gallery-add")[0])}))}}if("close"===o){a.attr("value","open"),a.val("open"),r.addClass("twer-lock--open");const e=s.find("select"),t=e.val(),l=e.attr("data-current");b(e)&&e.val(l),e.removeAttr("data-readonly"),e.attr("data-current",t),e.trigger("change");const o=s.find(".twer-switcher"),n=o.find("input:checkbox"),i=n.is(":checked"),c=o.attr("data-current");b(o)&&n.prop("checked",parseInt(c)),o.removeAttr("data-readonly"),o.attr("data-current",i?"1":"0"),n.trigger("change");const d=s.find(".icons-selector"),p=d.next("input"),m=p.val(),u=p.attr("data-current");b(p)&&(p.val(u),p.attr("value",u),"treweler-balloon-icon-picker"===p.attr("id")&&window.TWER_FONTPICKERS.setIcon(u),"treweler-dot-icon-picker"===p.attr("id")&&window.TWER_FONTPICKERS1.setIcon(u)),d.removeAttr("data-readonly"),p.removeAttr("data-readonly"),p.attr("data-current",m);const w=s.find(".twer-color-picker-wrap"),g=w.find(".input-color-field"),k=g.val(),h=w.find(".color-holder"),v=w.find(".twer-color-picker-palette"),f=w.attr("data-current");b(w)&&(g.val(f),g.attr("value",f),h.css("background-color",f),v.attr("acp-color",f)),w.removeAttr("data-readonly"),w.attr("data-current",k);const _=s.find(".large-text"),y=_.val(),N=_.attr("data-current");b(_)&&(_.val(N),_.attr("value",N)),_.removeAttr("data-readonly"),_.attr("data-current",y);const x=s.find(".twer-attach"),j=x.find('input[type="hidden"]'),$=j.val(),E=x.attr("data-current");b(x)&&(j.val(E),j.attr("value",E),x.find("img").attr("src",E)),x.removeAttr("data-readonly"),x.attr("data-current",$);const z=s.find(".js-twer-attach-gallery-wrap"),F=z.find('input[type="hidden"]'),C=F.val(),I=z.attr("data-current");b(z)&&(F.val(I),F.attr("value",I)),z.removeAttr("data-readonly"),z.attr("data-current",C)}e("#marker_style").trigger("change")})),e(document).on("change","#treweler-templates",(function(t){const r=e(this).val(),a=twer_ajax.templates;let l="none"===r?"reset":"set";const o=e(".js-twer-defaults"),s=e(".js-ui-slider-wrap"),n=e(".js-custom-fields-tabs");if("none"!==r){n.addClass("d-none"),e("#twer-nav-custom-fields-wo-template-tab").tab("show"),document.getElementById("twer-nav-template-tab").classList.add("nav-link--has-icon");const t=a[r];o.removeClass("d-none"),o.find("input").val("close"),o.find("input").attr("value","close"),o.find("a").removeClass("twer-lock--open"),s.find(".js-custom-fields-list").closest("tr").addClass("d-none"),s.find(".js-twer-ui-del-tr, .js-twer-ui-sort-tr, .js-twer-ui-disable-tr").addClass("d-none"),s.find(".twer-defaults").css("right",0);for(const r in t){const a=r,o=t[r];switch(a){case"balloon_icon_show":h("#treweler-picker","checkbox",o,l);break;case"custom_field_show_locator":h("#treweler-custom-field-show-locator","checkbox",o,l);break;case"custom_field_show_locator_preview":h("#treweler-custom-field-show-locator-preview","checkbox",o,l);break;case"custom_field_show":h("#treweler-custom-field-show","checkbox",o,l);break;case"uniqueTemplateCustomFieldsIds":const t=e("#treweler-custom-fields-list-unique").closest(".js-ui-slider-wrap"),r=e("#treweler-custom-fields-list-unique").val();if(b(e("#treweler-custom-fields-list-unique"))||e("#treweler-custom-fields-list-unique").attr("data-current",r),e("#treweler-custom-fields-list-unique").attr("data-readonly","true"),t.find(".js-twer-ui-del-tr").trigger("click"),o.length>0){let e="string"==typeof o?o.split(","):o;for(let r=0;r<e.length;r++)t.find(".js-custom-fields-list").val(e[r]),t.find(".js-add-custom-field").trigger("click")}t.find(".js-ui-slider-item").each((function(){const t=e(this).find(".js-twer-lock");t.hasClass("twer-lock--open")&&t.trigger("click")}));break;case"custom_marker_cursor":h("#marker_cursor","select",o,l);break;case"custom_marker_position":h("#marker_position","select",o,l);break;case"custom_marker_size":h("#treweler-marker-img-size","number",o,l);break;case"dot_corner_radius":h("#treweler-marker-corner-radius-group","number",o.size,l),h("#treweler-marker-corner-radius-group-select","select",o.units,l);break;case"dot_icon_show":h("#treweler-picker-dot","checkbox",o,l);break;case"label_description":h("#treweler-label-description","text",o,l);break;case"label_enable":h("#treweler-marker-enable-labels","checkbox",o,l);break;case"label_has_bg":h("#treweler-label-has-bg","checkbox",o,l);break;case"label_border_radius":h("#treweler-label-border-radius","number",o,l);break;case"label_letter_spacing":h("#treweler-label-letter-spacing","number",o,l);break;case"label_line_height":h("#treweler-label-line-height","number",o,l);break;case"label_margin":h("#treweler-label-margin","number",o,l);break;case"label_marker_hide":h("#treweler-marker-hide","checkbox",o,l);break;case"label_position":h("#treweler-label-position","select",o,l);break;case"label_size":h("#treweler-label-font-size","number",o,l);break;case"label_weight":h("#treweler-label-font-weight","select",o,l);break;case"marker_enable_clustering":h("#treweler-marker-enable-clustering","checkbox",o,l);break;case"marker_enable_center_on_click":h("#treweler-marker-enable-center-on-click","checkbox",o,l);break;case"marker_hide_in_locator":h("#treweler-marker-hide-in-locator","checkbox",o,l);break;case"marker_ignore_filters":h("#treweler-marker-ignore-filters","checkbox",o,l);break;case"marker_ignore_radius_filter":h("#treweler-marker-ignore-radius-filter","checkbox",o,l);break;case"marker_open_link_by_click":h("#treweler-marker-open-link-by-click","checkbox",o,l);break;case"marker_click_offset":h("#treweler-marker-click-offset-top","number",o.top,l),h("#treweler-marker-click-offset-bottom","number",o.bottom,l),h("#treweler-marker-click-offset-left","number",o.left,l),h("#treweler-marker-click-offset-right","number",o.right,l);break;case"marker_icon_size":h("#marker_icon_size","text",o,l);break;case"popup_gallery":h("#treweler-popup-gallery","gallery",o,l);break;case"popup_gallery_position":h("#treweler-popup-image-position","select",o,l);break;case"popup_gallery_show":h("#treweler-popup-gallery-show","checkbox",o,l);break;case"popup_gallery_width":h("#treweler-popup-image-width","number",o,l);break;case"popup_heading":h('[name="_treweler_popup_heading"]',"text",o.text,l),h('[name="_treweler_popup_heading_size"]',"number",o.size,l),h('[name="_treweler_popup_heading_font_weight"]',"select",o.weight,l);break;case"popup_description":h('[name="_treweler_popup_description"]',"text",o.text,l),h('[name="_treweler_popup_description_size"]',"number",o.size,l),h('[name="_treweler_popup_description_font_weight"]',"select",o.weight,l);break;case"popup_subheading":h('[name="_treweler_popup_subheading"]',"text",o.text,l),h('[name="_treweler_popup_subheading_size"]',"number",o.size,l),h('[name="_treweler_popup_subheading_font_weight"]',"select",o.weight,l);break;case"popup_button":h("#treweler-popup-button-text","text",o.text,l),h("#treweler-popup-button-url","url",o.url,l),h('[name="_treweler_popup_button[color]"]',"colorpicker",o.color,l),h("#treweler-popup-button-target","checkbox",o.target,l);break;case"popup_content_align":h("#treweler-popup-content-align","select",o,l);break;case"popup_open_on":h("#treweler-popup-open-group-open-on","select",o.action,l),h("#treweler-popup-open-group-open-default","checkbox",o.default,l);break;case"popup_close_button":h("#treweler-popup-close-button-style","select",o.style,l),h("#treweler-popup-close-button-show","checkbox",o.show,l);break;case"marker_link":h("#treweler-marker-link-url","text",o.url,l),h("#treweler-marker-link-target","checkbox",o.target,l);break;case"popup_show":h("#treweler-popup-show","checkbox",o,l);break;case"point_halo_opacity":h("#treweler-marker-halo-opacity","number",o,l);break;case"popup_border_radius":h("#treweler-popup-border-radius","number",o,l);break;case"popup_size":h("#treweler-popup-size-width","number",o.width,l),h("#treweler-popup-size-height","number",o.height,l);break;case"triangle_height":h("#treweler-marker-height-triangle","number",o,l);break;case"triangle_width":case"triangle_size":h("#treweler-marker-width-triangle","number",o,l);break;case"popup_style":h("#treweler-popup-style","select",o,l);break;case"balloon":h("#marker_color_balloon","colorpicker",o.color,l),h("#treweler-marker-size-balloon","number",o.size,l);break;case"balloon_border":h("#marker_border_color_balloon","colorpicker",o.color,l),h("#treweler-marker-border-width-balloon","number",o.size,l);break;case"balloon_dot":h("#marker_dot_color","colorpicker",o.color,l),h("#treweler-marker-dot-size","number",o.size,l);break;case"dot":h("#marker_dotcenter_color","colorpicker",o.color,l),h("#treweler-marker-size","number",o.size,l);break;case"dot_border":h("#marker_border_color","colorpicker",o.color,l),h("#treweler-marker-border-width","number",o.size,l);break;case"dot_icon":h("#dot_icon_color","colorpicker",o.color,l),h("#treweler-dot-icon-size","number",o.size,l);break;case"label_color":h("#twer-map-label-font-color","colorpicker",o,l);break;case"point_color":h("#markerColor","colorpicker",o,l);break;case"point_halo_color":h("#marker_halo_color","colorpicker",o,l);break;case"label_padding":h("#treweler-label-padding-top","number",o.top,l),h("#treweler-label-padding-bottom","number",o.bottom,l),h("#treweler-label-padding-left","number",o.left,l),h("#treweler-label-padding-right","number",o.right,l);break;case"triangle_color":h("#marker_color_triangle","colorpicker",o,l);break;case"balloon_icon":h("#balloon_icon_color","colorpicker",o.color,l),h("#treweler-balloon-icon-size","number",o.size,l);break;case"balloon_icon_picker":h("#treweler-balloon-icon-picker","iconpicker",o,l);break;case"dot_icon_picker":h("#treweler-dot-icon-picker","iconpicker",o,l);break;case"custom_marker_img":h("#thumbnail_id","image",o,l);break;case"marker_style":h("#marker_style","select",o,l)}}"custom"===e("#marker_style").val()?k.then((function(){e("#treweler-picker-dot, #treweler-picker, #marker_style, #treweler-popup-image-position, #treweler-popup-open-group-open-on, #treweler-marker-img-size").trigger("change")}),(function(t){e("#treweler-picker-dot, #treweler-picker, #marker_style, #treweler-popup-image-position, #treweler-popup-open-group-open-on").trigger("change")})):e("#treweler-picker-dot, #treweler-picker, #marker_style, #treweler-popup-image-position, #treweler-popup-open-group-open-on").trigger("change")}else n.removeClass("d-none"),e("#twer-nav-custom-fields-wo-template-tab").tab("show"),document.getElementById("twer-nav-template-tab").classList.remove("nav-link--has-icon"),o.addClass("d-none"),o.find("input").val("open"),o.find("input").attr("value","open"),o.find("a").removeClass("twer-lock--close"),s.find(".js-custom-fields-list").closest("tr").removeClass("d-none"),s.find(".js-twer-ui-del-tr, .js-twer-ui-sort-tr, .js-twer-ui-disable-tr").removeClass("d-none"),s.find(".twer-defaults").css("right","80px"),e(".js-twer-ui-del-tr").trigger("click"),e("[data-readonly]").each((function(){const t=e(this);t.removeAttr("data-readonly");let r=t.attr("data-current");if(b(t)){if(t.hasClass("large-select")&&t.val(r),t.hasClass("large-text")&&(t.val(r),t.attr("value",r)),t.hasClass("twer-switcher")&&t.find('input[type="checkbox"]').prop("checked",parseInt(r)),t.hasClass("twer-color-picker-wrap")&&(t.find(".input-color-field").val(r),t.find(".input-color-field").attr("value",r),t.find(".color-holder").css("background-color",r),t.find(".twer-color-picker-palette").attr("acp-color",r)),t.hasClass("js-twer-custom-fields-list")&&t.val()){let e=t.val().split(",");for(let r=0;r<e.length;r++)t.closest(".js-ui-slider-wrap").find(".js-custom-fields-list").val(e[r]),t.closest(".js-ui-slider-wrap").find(".js-add-custom-field").trigger("click")}if(t.hasClass("twer-attach-gallery")&&(t.find('input[type="hidden"]').val(r),t.find('input[type="hidden"]').attr("value",r),e(".twer-attach-gallery__thumb").remove(),r)){let t=r.split(",");for(let r=0;r<t.length;r++)wp.media.attachment(t[r]).fetch().then((function(a){let l=wp.media.attachment(t[r]).get("url"),o=document.createElement("div");o.setAttribute("class","twer-attach-gallery__thumb"),o.setAttribute("data-id",t[r]);let s=document.createElement("img");s.setAttribute("src",l);let n=document.createElement("a");n.setAttribute("href","#"),n.setAttribute("class","twer-attach-gallery__remove js-twer-attach-gallery-remove"),o.appendChild(s),o.appendChild(n),e(".js-twer-attach-gallery-wrap")[0].insertBefore(o,e(".js-twer-attach-gallery-add")[0])}))}if(t.hasClass("js-twer-attach-wrap-custom")){var a;e(".js-twer-attach-remove-custom").trigger("click");let l=r;t.find('input[type="hidden"]').val(r),t.find('input[type="hidden"]').attr("value",r);let o=t[0];const s=o.getElementsByClassName("js-twer-attach-thumb-custom")[0],n=e(".js-twer-attach-add-custom")[0],i=document.createElement("IMG");i.setAttribute("src",l),null===(a=o.getElementsByTagName("img")[0])||void 0===a||a.remove(),s.appendChild(i),n.classList.contains("button")||(n.style.display="none"),s.nextElementSibling.style.display="block",o.getElementsByTagName("input")[0].value=l}}t.removeAttr("data-current"),t.removeAttr("data-default")})),e("#treweler-picker-dot, #treweler-picker, #marker_style, #treweler-popup-image-position, #treweler-popup-open-group-open-on, #treweler-marker-img-size").trigger("change"),setTimeout((function(){e("#marker_style").trigger("change")}),500);setTimeout((()=>{i()}),600)}))}))}(jQuery),window.addEventListener("DOMContentLoaded",(()=>{const e=()=>{const e=document.getElementsByClassName("js-toggle-row");if(e.length>0)for(let t=0;t<e.length;t++){const r=e[t];let a=r.dataset.relatedVal;const l=r.dataset.relatedId;let o;"1"===a||"0"===a?(o="checkbox",a="1"===a):(o="select",a=a.split(","));const s=document.getElementById(l),n=s.value;s.closest(".twer-tr-toggle").classList.contains("d-none")?r.classList.add("d-none"):"select"===o?a.includes(n)?r.classList.remove("d-none"):r.classList.add("d-none"):"checkbox"===o&&(a===s.checked?r.classList.remove("d-none"):r.classList.add("d-none"))}};e(),document.getElementById("treweler-marker-open-link-by-click").onchange=function(){e()},document.getElementById("marker_style").onchange=function(){e()},document.getElementById("treweler-picker").onchange=function(){e(),n(["treweler-picker","treweler-picker-dot"],["treweler-balloon-icon-picker","treweler-dot-icon-picker"],["balloon_icon_color","dot_icon_color"],["treweler-balloon-icon-size","treweler-dot-icon-size"])},document.getElementById("treweler-picker-dot").onchange=function(){e(),n(["treweler-picker","treweler-picker-dot"],["treweler-balloon-icon-picker","treweler-dot-icon-picker"],["balloon_icon_color","dot_icon_color"],["treweler-balloon-icon-size","treweler-dot-icon-size"])},null!==document.getElementById("treweler-label-has-bg")&&(document.getElementById("treweler-label-has-bg").onchange=function(){e()})})),window.addEventListener("load",(()=>{}))}();